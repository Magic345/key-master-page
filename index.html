<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Аварийное открытие замков в Мариуполе</title>
    <meta name="description" content="Срочное вскрытие замков и изготовление ключей в Мариуполе.
    Приедем за 20 минут! Изготовим ключ за 10 минут. Аварийное вскрытие сейфов, авто, квартир. Гарантия.">
    
    <!-- Основная иконка для браузеров -->
    <link rel="icon" href="/favicon.ico" type="favicon.ico">
    <!-- Для современных браузеров -->
    <link rel="icon" href="/favicon-32x32.png" type="image/png" sizes="32x32">
    <link rel="icon" href="/favicon-16x16.png" type="image/png" sizes="16x16">
    <link rel="stylesheet" href="./styles/style.css">
    <base href="/storage/v1/object/public/key-master/key-master-page">
    <meta property="og:title" content="Аварийное открытие замков в Мариуполе">
    <meta property="og:description" content="Срочное вскрытие замков и изготовление ключей в Мариуполе. 
    Приедем за 20 минут! Изготовим ключ за 10 минут. Аварийное вскрытие сейфов, авто, квартир. Гарантия.">
    
</head>
<body>
    <header>
        <nav class="nav-bar">
        
            <div class="logo">
                <a href="#" class="logo-link">
                    <img src="./resources/img/logo.svg" alt="" class="logo-img">
                    <span class="logo-text">аварийное<br> открытие<br> замков</span>
                </a>
            </div>

            <ul class="nav-links">
                <li><a href="#contact">контакты</a></li>
                <li><a href="#services">услуги</a></li>
                <li><a href="#faq">отзывы</a></li>
                <li class="faq"><a href="#review">вопросы</a></li>
            </ul>

            <div class="contact-button">
                <a href="tel:+79497090556 "><img class="phone-icon" src="./resources/img/phone.svg" alt=""></a>
            </div>
       
        </nav>
    </header>
    
    <main>
        <section class="description-section">
            <div class="container-left">
                <div class="description-content">
                    <div class="description-title">
                        <h1>Потеряли ключи? <br> Забыли код? <br> <span>Мы поможем!</span></h1>
                        <h3>Приедем за 15 минут</h3>
                    </div>
                    <div class="description-button">
                        <a href="tel:+79497090556">Вызвать мастера →</a>
                    </div>
                </div>
                <!-- Таблица -->
                <div class="features-grid">
                    <div class="grid">
                        <div class="feature-card">
                            <h4>Замена корпусов для авто ключей</h4>
                        </div>
                        <div class="feature-card">
                            <h4>Замена дверных замков </h4>
                        </div>
                        <div class="feature-card">
                            <h4>Изготовление любой сложности ключей </h4>
                        </div>
                        <div class="feature-card">
                            <h4>Ремонт автозамков и ключей</h4>
                        </div>
                        <div class="feature-card">
                            <h4>Автоключи с чипом</h4>
                        </div>
                        <div class="feature-card">
                            <h4>Восстановление при полной утере</h4>
                        </div>
                    </div>
                </div>
            </div>
            </div>

        </section>

        <section class="select-lock-section" id="services">
            <div class="container-left">
                <div class="lock-title">
                    <h1>Какой замок необходимо <br><span>вскрыть?</span></h1>
                </div>
            
            
                <!-- Сетка из 4 карточек -->
                <div class="lock-grid">
                    <div class="lock-card">
                        <h3>Квартирный замок</h3>
                        <img src="./resources/img/квартирный_замок.svg" alt="Квартирный замок">
                    </div>
                    <div class="lock-card">
                        <h3>Домашний замок</h3>
                        <img src="./resources/img/домашний_замок.svg" alt="Домашний замок">
                    </div>
                    <div class="lock-card">
                        <h3>Автомобильный замок</h3>
                        <img src="./resources/img/автомобильный_замок.svg" alt="Автомобильный замок">
                    </div>
                    <div class="lock-card">
                        <h3>Открытие сейфов</h3>
                        <img src="./resources/img/открытие_сейфов.svg" alt="Открытие сейфов">
                    </div>
    
                </div>
                <div class="big-button" style="padding-top: calc(62px - 32px);">
                    <a href="tel:+79497090556 ">Оставить заявку</a>
                </div>
            </div>
        </section>


        <section class="faq-section" id="faq">
            <div class="container-left">
                <div class="faq-title">
                    <h1>Остались вопросы? <br><span>Cмотри ответы на частозадаваемые</span></h1>
                </div>
                <div class="faq-list">
                    <!-- Вопрос 1 -->
                    <div class="faq-item">
                        <button class="faq-question">
                        <span class="arrow"></span>
                        Сколько времени занимает вскрытие замка?
                        </button>
                        <div class="faq-answer">
                        Обычно процесс занимает от 5 до 15 минут, в зависимости от типа замка и сложности.
                        </div>
                    </div>

                    <!-- Вопрос 2 -->
                    <div class="faq-item">
                        <button class="faq-question">
                        <span class="arrow"></span>
                        Работаете ли вы в выходные?
                        </button>
                        <div class="faq-answer">
                        Да, мы работаем 24/7, включая праздники и выходные.
                        </div>
                    </div>

                    <!-- Вопрос 3 -->
                    <div class="faq-item">
                        <button class="faq-question">
                        <span class="arrow"></span>
                        Повредите ли вы дверь при вскрытии?
                        </button>
                        <div class="faq-answer">
                        Нет, наши мастера используют профессиональные инструменты, которые позволяют открыть замок без повреждений.
                        </div>
                    </div>

                    <!-- Вопрос 4 -->              
                    <div class="faq-item">
                        <button class="faq-question">
                        <span class="arrow"></span>
                        Повредите ли вы дверь при вскрытии?
                        </button>
                        <div class="faq-answer">
                        Нет, наши мастера используют профессиональные инструменты, которые позволяют открыть замок без повреждений.
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="reviews-section" id="reviews">
            <div class="container-left">
                <div class="reviews-title">
                    <h1>Отзывы <br><span>Тех кому мы уже помогли</span></h1>    
            </div>
            </div>
            
            <div class="reviews-content">
                <div class="reviews-carousel-wrapper">
                    <!-- Карусель -->
                    <div class="reviews-carousel">
                        <div class="review-card">
                            <h3>Анна Петрова</h3>
                            <p>Быстро и аккуратно открыли дверь, когда я случайно закрылась. Мастер приехал за 12 минут, не повредил замок. Рекомендую!</p>
                        </div>
                        <div class="review-card">
                            <h3>Игорь Сидоров</h3>
                            <p>Потерял ключи от машины. Вызвал, приехали быстро, открыли без повреждений. Цена адекватная. Спасибо!</p>
                        </div>
                        <div class="review-card">
                            <h3>Ольга Кузнецова</h3>
                            <p>Работают 24/7, ночью открыли дверь, когда ребёнок остался один дома. Очень благодарна за оперативность.</p>
                        </div>
                    </div>
                </div>
                <!-- Индикаторы -->
                <div class="carousel-indicators">
                <!-- Точки будут добавлены автоматически -->
                </div>
                <!-- Кнопка "Оставить отзыв" -->
                <div class="review-button">
                    <a href="#" id="open-review-form">Оставить отзыв</a>
                </div>

                    <!-- Форма для отзыва (скрыта по умолчанию) -->
                <div class="review-form-container" id="review-form-container" style="display: none;">
                    <form class="review-form" id="review-form">
                        <input type="text" id="review-name" placeholder="Ваше имя" required>
                        <textarea id="review-text" placeholder="Ваш отзыв" rows="4" required></textarea>
                        <button type="submit">Отправить</button>
                        <button type="button" id="close-form">Закрыть</button>
                    </form>
                </div>           
        </div>
        </section>

            <!-- === Секция: Контакты === -->
        <section class="contacts-section mobile-version" style="display: none;" id="contact">
            <div class="container-left">
                <div class="contact-title">
                    <h1>Контакты</h1>
            </div>
            </div>
            
                <div class="contacts-grid">
                    <div class="contact-bottom-row">
                        <!-- Колонка 1: Логотип и кнопка -->
                        <div class="contact-col contact-logo">
                            <div class="contact-logo">
                            <a href="#" class="logo-link">
                                <img src="./resources/img/logo.svg" alt="Логотип" class="logo-img">
                                <span class="logo-text">аварийное<br> открытие<br> замков</span>
                            </a>
                            </div>
                            <div class="contact-button">
                                <a href="tel:+79497090556" class="master-button">Вызвать мастера →</a>
                            </div>
                        </div>
                        
                        <!-- Колонка 2: Навигация -->
                        <div class="contact-col">
                            <ul class="contact-nav contact-nav">
                                <li><a href="#services">Услуги</a></li>
                                <li><a href="#reviews">Отзывы</a></li>
                                <li><a href="#faq">Вопросы</a></li>
                            </ul>
                        </div>
                    </div>
                        <!-- Колонка 3: Телефоны -->
                    <div class="contact-col contact-phones">
                        <div class="phones">
                            <a href="tel:+79497090556" class="phone-link">+7 (949) 709-05-56</a>
                            <a href="tel:+79490020164" class="phone-link">+7 (949) 002-01-64</a>
                        </div>
                    </div>    
                </div>
            
        </section>

        <section class="contacts-section dectop-version" id="contact">
            <div class="container-left">
                <div class="contact-title">
                    <h1>Контакты</h1>
            </div>
            </div>
            
                <div class="contacts-grid">
                        <!-- Колонка 1: Логотип и кнопка -->
                        <div class="contact-col">
                            <div class="contact-logo">
                            <a href="#" class="logo-link">
                                <img src="./resources/img/logo.svg" alt="Логотип" class="logo-img">
                                <span class="logo-text">аварийное<br> открытие<br> замков</span>
                            </a>
                            </div>
                            <div class="contact-button">
                                <a href="tel:+79497090556" class="master-button">Вызвать мастера →</a>
                            </div>
                        </div>
                        
                        <!-- Колонка 2: Навигация -->
                        <div class="contact-col">
                            <ul class="contact-nav">
                                <li><a href="#services">Услуги</a></li>
                                <li><a href="#reviews">Отзывы</a></li>
                                <li><a href="#faq">Вопросы</a></li>
                            </ul>
                        </div>
                    
                        <!-- Колонка 3: Телефоны -->
                    <div class="contact-col">
                        <div class="phones">
                            <a href="tel:+79497090556" class="phone-link">+7 (949) 709-05-56</a>
                            <a href="tel:+79490020164" class="phone-link">+7 (949) 002-01-64</a>
                        </div>
                    </div>    
                </div>
        </section>
    </main>


    <script>
        // === FAQ (оставляем) ===
        document.querySelectorAll('.faq-question').forEach(button => {
            button.addEventListener('click', () => {
            const item = button.parentElement;
            const isActive = item.classList.contains('active');
            document.querySelectorAll('.faq-item').forEach(el => el.classList.remove('active'));
            if (!isActive) item.classList.add('active');
            });
        });

        // === Конфигурация Supabase ===
        const SUPABASE_URL = 'https://lwopftxlqhtwmmcpiubt.supabase.co'; // ← ваш URL
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx3b3BmdHhscWh0d21tY3BpdWJ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU3OTY1NjgsImV4cCI6MjA4MTM3MjU2OH0.2WPvP8tvodkU_2DCPoMiME0O0Z10KuI-iVyyDmfCq7w'; // ← ваш anon ключ

        const headers = {
            'apikey': SUPABASE_ANON_KEY,
            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
            'Content-Type': 'application/json'
        };

        // === DOM ===
        const carousel = document.querySelector('.reviews-carousel');
        const indicatorsContainer = document.querySelector('.carousel-indicators');
        const openFormBtn = document.getElementById('open-review-form');
        const formContainer = document.getElementById('review-form-container');
        const closeFormBtn = document.getElementById('close-form');
        const reviewForm = document.getElementById('review-form');
        let reviewCards = [];

        // === Загрузка отзывов ===
        async function loadReviews() {
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/reviews?order=created_at.desc`, { headers });
            if (!response.ok) throw new Error('Ошибка загрузки');
            
            const reviews = await response.json();
            carousel.innerHTML = '';
            reviews.forEach(review => addReviewToDOM(review.name, review.text));
            updateReviewCards();
            } catch (err) {
                console.error('Не удалось загрузить отзывы:', err);
                alert('Ошибка загрузки отзывов. Обновите страницу.');
            }
        }

        // === Добавить отзыв в DOM ===
        function addReviewToDOM(name, text) {
            const card = document.createElement('div');
            card.className = 'review-card';
            card.innerHTML = `<h3>${name}</h3><p>${text}</p>`;
            carousel.appendChild(card);
        }

        // отправка отзыва
        reviewForm.addEventListener('submit', async function (e) {
            e.preventDefault();

            const name = document.getElementById('review-name').value.trim();
            const text = document.getElementById('review-text').value.trim();

            if (!name || !text) return alert('Заполните все поля');

            const today = new Date().toDateString(); // "Mon Dec 02 2024"
            const reviewLog = JSON.parse(localStorage.getItem('reviewsLog') || '{}');

            // Проверяем, сколько отзывов уже отправлено сегодня
            if (reviewLog[today] && reviewLog[today] >= 2) {
                alert('Вы уже отправили 2 отзыва сегодня. Попробуйте завтра.');
                return;
            }

            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/reviews`, {
                    method: 'POST',
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ name, text })
                });

                if (response.ok) {
                    // Сохраняем в localStorage
                    reviewLog[today] = (reviewLog[today] || 0) + 1;
                    localStorage.setItem('reviewsLog', JSON.stringify(reviewLog));

                    addReviewToDOM(name, text);
                    updateReviewCards();
                    this.reset();
                    formContainer.style.display = 'none';
                    alert('Спасибо за отзыв! Он уже на сайте.');
                } else {
                    const err = await response.json();
                    console.error('Ошибка:', err);
                    alert('Ошибка при отправке: ' + (err.message || 'Неизвестная ошибка'));
                }
            } catch (err) {
                console.error('Сеть:', err);
                alert('Не удалось отправить отзыв. Проверьте интернет.');
            }
        });
        
        // === Кнопки ===
        openFormBtn.addEventListener('click', (e) => {
            e.preventDefault();
            formContainer.style.display = 'block';
        });

        closeFormBtn.addEventListener('click', () => {
            formContainer.style.display = 'none';
        });

        // === Карусель и индикаторы ===
        function updateReviewCards() {
            reviewCards = document.querySelectorAll('.review-card');
            createIndicators();
        }

        function createIndicators() {
            indicatorsContainer.innerHTML = '';
            reviewCards.forEach((_, index) => {
            const indicator = document.createElement('div');
            indicator.classList.add('carousel-indicator');
            if (index === 0) indicator.classList.add('active');
            indicator.addEventListener('click', () => scrollToCard(index));
            indicatorsContainer.appendChild(indicator);
            });
        }

        function scrollToCard(index) {
            const card = reviewCards[index];
            const offset = card.offsetLeft - (carousel.offsetWidth - card.offsetWidth) / 2;
            carousel.scrollTo({ left: offset, behavior: 'smooth' });
            document.querySelectorAll('.carousel-indicator').forEach((dot, i) => {
            dot.classList.toggle('active', i === index);
            });
        }

        carousel.addEventListener('scroll', () => {
            const scrollLeft = carousel.scrollLeft + carousel.offsetWidth / 2;
            let newIndex = 0;
            reviewCards.forEach((card, i) => {
            if (card.offsetLeft <= scrollLeft) newIndex = i;
            });
            document.querySelectorAll('.carousel-indicator').forEach((dot, i) => {
            dot.classList.toggle('active', i === newIndex);
            });
        });

        // === Загрузка при старте ===
        loadReviews();
</script>


</body>
</html>